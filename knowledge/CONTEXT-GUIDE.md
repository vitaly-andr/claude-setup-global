# Context-Aware Knowledge: Руководство

Быстрая шпаргалка для определения куда сохранять решения.

## Простое правило

**Спроси себя**: "Это решение будет полезно в других проектах?"

- **ДА** → Сохранить **ГЛОБАЛЬНО** (`~/.claude/knowledge/`)
- **НЕТ** → Сохранить **В ПРОЕКТЕ** (`./.claude/knowledge/`)
- **НЕ ЗНАЮ** → Спросить пользователя

## Примеры ГЛОБАЛЬНЫХ решений

✅ **Всегда глобально**:
- Команды pacman, yay
- Настройка Hyprland, Waybar
- Системные сервисы (systemd)
- Конфигурация сети
- Настройка ядра
- Общие Linux troubleshooting
- IDE настройки (общие)
- Git конфигурация (общая)

**Почему**: Переиспользуются на всех проектах и машинах

## Примеры ПРОЕКТНЫХ решений

✅ **Всегда в проекте**:
- Dockerfile для этого проекта
- docker-compose.yml конфигурация
- Django settings.py пояснения
- Специфичные npm scripts
- API endpoints документация
- База данных schema этого проекта
- Environment variables для проекта
- CI/CD pipeline этого проекта
- Deployment инструкции для этого проекта

**Почему**: Специфичны для архитектуры/стека этого проекта

## Серая зона (нужно решать)

⚠️ **Зависит от контекста**:

### PostgreSQL настройка
- **Глобально**: Общие команды psql, создание пользователей
- **Проектно**: Схема БД для проекта, миграции

### Docker вообще
- **Глобально**: Основные команды docker, docker-compose
- **Проектно**: Dockerfile и compose файлы конкретного проекта

### Nginx конфигурация
- **Глобально**: Общая настройка nginx, базовый reverse proxy
- **Проектно**: Конфигурация nginx для конкретного приложения

### Python/Node.js решения
- **Глобально**: Установка Python/Node, общие инструменты
- **Проектно**: Зависимости проекта, project-specific скрипты

## Decision Tree для агентов

```
Решение найдено
    ↓
Проверь ключевые слова в решении:
    ↓
┌─────────────────────────────────────────┐
│ Ключевые слова ПРОЕКТА:                 │
│ • "this project", "our app"             │
│ • Названия файлов проекта               │
│ • "deployment for X"                    │
│ • Framework-specific (Django, React)    │
│ • "database schema"                     │
│ • docker-compose, Dockerfile           │
└─────────────────────────────────────────┘
         ↓
    PROJECT (./.claude/knowledge/)

┌─────────────────────────────────────────┐
│ Ключевые слова СИСТЕМЫ:                 │
│ • "pacman", "systemd"                   │
│ • "Hyprland", "Waybar"                  │
│ • "Arch Linux"                          │
│ • Общие Linux команды                   │
│ • Desktop environment                   │
└─────────────────────────────────────────┘
         ↓
    GLOBAL (~/.claude/knowledge/)

┌─────────────────────────────────────────┐
│ Неочевидно?                             │
│ • Может быть и так и так                │
│ • Содержит элементы обоих               │
└─────────────────────────────────────────┘
         ↓
    ASK USER
```

## Частые ошибки

❌ **НЕ сохранять глобально**:
- Секреты проекта (API keys, passwords)
- Специфичные URL (кроме как примеры)
- Имена баз данных проекта
- Project-specific переменные окружения

❌ **НЕ сохранять в проект**:
- Общие pacman команды
- Hyprland keybindings
- Системные troubleshooting (не связанные с проектом)

## Синхронизация

**Глобальная база** (`~/.claude/knowledge/`):
```bash
cd ~/.claude
git add knowledge/
git commit -m "Add nginx general config"
git push  # Доступно на всех ваших машинах
```

**Проектная база** (`./.claude/knowledge/`):
```bash
cd /path/to/project
git add .claude/knowledge/
git commit -m "Add Docker setup documentation"
git push  # Доступно всей команде проекта
```

## Для новых проектов

Инициализировать проектную базу знаний:

```bash
cd /path/to/new-project
~/.claude/knowledge/project-init.sh
```

Это создаст структуру `.claude/knowledge/` с правильными категориями.

---

**Правило большого пальца**: Если сомневаешься - сохрани в проект. Всегда можно потом переместить в глобальную базу, если окажется что решение универсальное.

---
Создано: 2025-10-21
